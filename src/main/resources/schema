-- tables
-- Table: answer_accordance
CREATE TABLE answer_accordance (
  answer_accordance_id bigint NOT NULL AUTO_INCREMENT,
  correct_map_id bigint NOT NULL,
  question_id bigint NOT NULL,
  CONSTRAINT answer_accordance_pk PRIMARY KEY (answer_accordance_id)
);

-- Table: answer_number
CREATE TABLE answer_number (
  answer_number_id bigint NOT NULL AUTO_INCREMENT,
  question_id bigint NOT NULL,
  correct int NOT NULL,
  CONSTRAINT answer_space_pk PRIMARY KEY (answer_number_id)
);

-- Table: answer_sequence
CREATE TABLE answer_sequence (
  answer_sequence_id bigint NOT NULL AUTO_INCREMENT,
  question_id bigint NOT NULL,
  correct_list_id bigint NOT NULL,
  CONSTRAINT answer_sequence_pk PRIMARY KEY (answer_sequence_id)
);

-- Table: answer_simple
CREATE TABLE answer_simple (
  answer_simple_id bigint NOT NULL AUTO_INCREMENT,
  question_id bigint NOT NULL,
  body varchar(256) NOT NULL,
  correct bool NOT NULL,
  CONSTRAINT answer_simple_pk PRIMARY KEY (answer_simple_id)
);

-- Table: correct_list
CREATE TABLE correct_list (
  correct_list_id bigint NOT NULL AUTO_INCREMENT,
  item varchar(256) NOT NULL,
  CONSTRAINT correct_list_pk PRIMARY KEY (correct_list_id)
);

-- Table: correct_map
CREATE TABLE correct_map (
  correct_map_id bigint NOT NULL AUTO_INCREMENT,
  left_side varchar(64) NOT NULL,
  right_side varchar(64) NOT NULL,
  CONSTRAINT correct_map_pk PRIMARY KEY (correct_map_id)
);

-- Table: group
CREATE TABLE `group` (
  group_id bigint NOT NULL AUTO_INCREMENT,
  name varchar(64) NOT NULL,
  description varchar(2048) NULL,
  creation_date date NOT NULL,
  CONSTRAINT group_pk PRIMARY KEY (group_id)
);

-- Table: question
CREATE TABLE question (
  question_id bigint NOT NULL AUTO_INCREMENT,
  quiz_id bigint NOT NULL,
  name varchar(64) NOT NULL,
  body varchar(2048) NOT NULL,
  explanation varchar(2048) NULL,
  question_type varchar(64) NOT NULL,
  score int NOT NULL,
  CONSTRAINT question_pk PRIMARY KEY (question_id)
);

-- Table: quiz
CREATE TABLE quiz (
  quiz_id bigint NOT NULL AUTO_INCREMENT,
  name varchar(64) NOT NULL,
  description varchar(2048) NULL,
  explanation varchar(2048) NULL,
  creation_date date NOT NULL,
  passing_time time NULL,
  author_id bigint NOT NULL,
  CONSTRAINT quiz_pk PRIMARY KEY (quiz_id)
);

-- Table: user
CREATE TABLE user (
  user_id bigint NOT NULL AUTO_INCREMENT,
  group_id bigint NOT NULL,
  first_name varchar(64) NULL,
  last_name varchar(64) NULL,
  email varchar(64) NOT NULL,
  date_of_birth varchar(64) NULL,
  phone_number varchar(64) NOT NULL,
  photo blob NULL,
  login varchar(64) NOT NULL,
  password varchar(64) NOT NULL,
  user_role varchar(64) NOT NULL,
  CONSTRAINT user_pk PRIMARY KEY (user_id)
);

-- Table: user_quiz_junction
CREATE TABLE user_quiz_junction (
  user_quiz_junction_id bigint NOT NULL AUTO_INCREMENT,
  user_id bigint NOT NULL,
  quiz_id bigint NOT NULL,
  result int NOT NULL,
  submit_date date NULL,
  finish_date date NULL,
  reopen_counter int NOT NULL,
  quiz_status varchar(64) NOT NULL,
  CONSTRAINT user_quiz_junction_pk PRIMARY KEY (user_quiz_junction_id)
);

-- foreign keys
-- Reference: User_Group (table: user)
ALTER TABLE user ADD CONSTRAINT user_group_fk FOREIGN KEY (group_id)
REFERENCES `group` (group_id);

-- Reference: answer_accordance_correct_map (table: answer_accordance)
ALTER TABLE answer_accordance ADD CONSTRAINT answer_accordance_correct_map_fk FOREIGN KEY (correct_map_id)
REFERENCES correct_map (correct_map_id);

-- Reference: answer_accordance_question (table: answer_accordance)
ALTER TABLE answer_accordance ADD CONSTRAINT answer_accordance_question_fk FOREIGN KEY (question_id)
REFERENCES question (question_id);

-- Reference: correct_list_answer_sequence (table: answer_sequence)
ALTER TABLE answer_sequence ADD CONSTRAINT correct_list_answer_sequence_fk FOREIGN KEY (correct_list_id)
REFERENCES correct_list (correct_list_id);

-- Reference: question_answer_sequence (table: answer_sequence)
ALTER TABLE answer_sequence ADD CONSTRAINT question_answer_sequence_fk FOREIGN KEY (question_id)
REFERENCES question (question_id);

-- Reference: question_answer_simple (table: answer_simple)
ALTER TABLE answer_simple ADD CONSTRAINT question_answer_simple_fk FOREIGN KEY (question_id)
REFERENCES question (question_id);

-- Reference: question_answer_space (table: answer_number)
ALTER TABLE answer_number ADD CONSTRAINT question_answer_space_fk FOREIGN KEY (question_id)
REFERENCES question (question_id);

-- Reference: question_quiz (table: question)
ALTER TABLE question ADD CONSTRAINT question_quiz_fk FOREIGN KEY (quiz_id)
REFERENCES quiz (quiz_id);

-- Reference: user_quiz_junction_quiz (table: user_quiz_junction)
ALTER TABLE user_quiz_junction ADD CONSTRAINT user_quiz_junction_quiz_fk FOREIGN KEY (quiz_id)
REFERENCES quiz (quiz_id);

-- Reference: user_quiz_junction_user (table: user_quiz_junction)
ALTER TABLE user_quiz_junction ADD CONSTRAINT user_quiz_junction_user_fk FOREIGN KEY (user_id)
REFERENCES user (user_id);